{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "COMMAND=$(echo \"$CLAUDE_TOOL_INPUT\" | jq -r '.command' 2>/dev/null); if echo \"$COMMAND\" | grep -q '^git commit'; then echo '🔍 檢查 Git 提交格式...'; if ! echo \"$COMMAND\" | grep -qE '\\[20[0-9]{6}\\]'; then echo '❌ 提交格式錯誤：必須包含 [YYYYMMDD] 格式' >&2; exit 1; fi; if echo \"$COMMAND\" | grep -qiE '(AI|Claude|Anthropic|LLM|機器人|自動生成|Generated|Automated|Bot|Assistant|🤖)'; then echo '❌ 提交訊息包含禁止詞彙' >&2; exit 1; fi; echo '✅ Git 提交格式檢查通過'; fi; if echo \"$COMMAND\" | grep -qE 'ln -s'; then echo '❌ 避免創建符號連結：Google Drive 同步衝突' >&2; exit 1; fi"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "COMMAND=$(echo \"$CLAUDE_TOOL_INPUT\" | jq -r '.command' 2>/dev/null); if echo \"$COMMAND\" | grep -qE '^git (add|commit|push|pull|merge)'; then if [ -d \"memories/logs\" ]; then echo \"$(date '+%Y-%m-%d %H:%M:%S') | Git 操作: $COMMAND\" >> memories/logs/git_operations_$(date +%Y%m).log; fi; fi"
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -d \"memories\" ]; then mkdir -p memories/logs memories/short_term && SESSION_INFO=\"$(date '+%Y-%m-%d %H:%M:%S') | 工作目錄: $(pwd) | 當前分支: $(git branch --show-current 2>/dev/null || echo 'N/A')\"; echo \"$SESSION_INFO\" >> memories/logs/sessions_$(date +%Y%m).log && echo -e \"最後工作時間: $(date '+%Y-%m-%d %H:%M:%S')\\n最後工作目錄: $(pwd)\\n最後 Git 分支: $(git branch --show-current 2>/dev/null || echo 'N/A')\" > memories/short_term/last_session.txt && echo '🔄 記憶體系統已更新'; fi"
          }
        ]
      }
    ]
  }
}